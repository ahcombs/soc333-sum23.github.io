{
  "hash": "f2d9fb87f039879dfa38da8f403951c6",
  "result": {
    "markdown": "---\ntitle: \"Hypothesis testing\"\nformat: html\neditor: visual\n---\n\n\n# Exercise: Hypothesis testing\n\n## Setup: run these two chunks first!\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# the infer package is new, so we need to install it.\n# this one only needs to be run one time\ninstall.packages(\"infer\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(openintro)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: airports\nLoading required package: cherryblossom\nLoading required package: usdata\n```\n:::\n\n```{.r .cell-code}\n# we're adding the infer package to our lineup today\nlibrary(infer)\n```\n:::\n\n\n## Q1: Determining the correct hypothesis test, part 1. *See slides from lecture 15 for solutions*\n\nFor each of these research questions, identify the explanatory variable, the response variable, their types, and the correct statistical test. *Think about what the data would look like for each individual in these cases*\n\na. How does the amount of money a country spends on healthcare (per person) affect its average life expectancy?\n\n    -   Explanatory variable(s) and type(s)?\n    -   Response variable and type?\n    -   Correct statistical test?\n\n## Q2: Determining the correct hypothesis test, part 2. *See slides from lecture 15 for solutions*\n\nSame thing, new questions. For each, identify the explanatory variable, the response variable, their types, and the correct statistical test.\n\nb. How is a patient's body mass index related to the probability a doctor refers them to a specialist?\n\n    -   Explanatory variable(s) and type(s)?\n    -   Response variable and type?\n    -   Correct statistical test?\n\nc. How do outcomes of traffic stops (which can be warnings, citations, or arrests) vary by the driver's race?\n\n    -   Explanatory variable(s) and type(s)?\n    -   Response variable and type?\n    -   Correct statistical test?\n\n## Q3: Running your first hypothesis test!\n\nWe will be returning to the `acs12` data for this exercise. We will be using two variables: `gender` and `married`.\n\nBoth are categorical variables with two categories (male/female for gender, yes/no for married), so we'll use a two-sample Z test, just like in the class example.\n\nResearch question: How is someone's gender identity related to their probability of being married?\n\nHere's a table to show the relationship between the two variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(acs12$gender, acs12$married)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        \n          no yes\n  male   584 447\n  female 583 386\n```\n:::\n:::\n\n\n### Step 1: Calculate the test statistic\n\nThen look at it in the data viewer. What is the Z score of this sample?\n\n**The Z score of this sample is about 1.6**\n\n(You might notice that R gives you a warning message. This is fine in this case! It just means we shouldn't read into the positive/negative sign on the Z score. But since we're doing a two-tailed test here, that didn't matter anyway.)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntest_stat <- acs12 |> \n  specify(explanatory = gender,\n          response = married,\n          success = \"yes\") |> \n  hypothesize(null = \"independence\") |> \n  calculate(stat = \"z\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The statistic is based on a difference or ratio; by default, for\ndifference-based statistics, the explanatory variable is subtracted in the\norder \"male\" - \"female\", or divided in the order \"male\" / \"female\" for\nratio-based statistics. To specify this order yourself, supply `order =\nc(\"male\", \"female\")` to the calculate() function.\n```\n:::\n:::\n\n\n### Step 2: Simulate the null distribution\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1. copy your code from above\n# 2. change the name of the object from test_stat to null_dist\n# 3. add generate(reps = 1000) in the correct place, like in the class example\n\nnull_dist <- acs12 |> \n  specify(explanatory = gender,\n          response = married,\n          success = \"yes\") |> \n  hypothesize(null = \"independence\") |> \n  generate(reps = 1000) |> \n  calculate(stat = \"z\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSetting `type = \"permute\"` in `generate()`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The statistic is based on a difference or ratio; by default, for\ndifference-based statistics, the explanatory variable is subtracted in the\norder \"male\" - \"female\", or divided in the order \"male\" / \"female\" for\nratio-based statistics. To specify this order yourself, supply `order =\nc(\"male\", \"female\")` to the calculate() function.\n```\n:::\n:::\n\n\n### Step 3: Calculate the p value of your sample\n\nThen interpret it. At a threshold value of p = 0.05, do you reject or fail to reject the null hypothesis that about the same number of men are married as women?\n\n**I fail to reject the null hypothesis that about the same number of men are married as women. My p value, 0.116, is above my cutoff value of 0.05.**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_p_value(null_dist,\n            obs_stat = test_stat,\n            direction = \"two-sided\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  p_value\n    <dbl>\n1   0.112\n```\n:::\n:::\n\n\n### Step 4: Visualize where your sample is with respect to your null distribution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvisualize(null_dist) +\n  shade_p_value(obs_stat = test_stat, direction = \"two-sided\")\n```\n\n::: {.cell-output-display}\n![](ex-6-13-solutions_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "ex-6-13-solutions_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}