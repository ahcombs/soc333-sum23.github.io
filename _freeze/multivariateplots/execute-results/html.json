{
  "hash": "ca3937ed5475fd4f2410d62eef644216",
  "result": {
    "markdown": "---\ntitle: \"Multivariate plots extra credit\"\neditor: visual\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(openintro)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: airports\nLoading required package: cherryblossom\nLoading required package: usdata\n```\n:::\n:::\n\n\n\n## Three numeric variables: using `size` and `color`\n\nYou might have a question that involves three numeric variables--for example, \"how does the relationship between hours worked and income vary by age?\"\n\nScatter plots are the natural choice for showing the relationship between two numeric variables. We can add a third numeric variable using `size` or `color`.\n\nHere, I am putting hours worked on the x axis (as an explanatory variable), income on the y axis (as a dependent variable), and using `color` to plot respondent age (also an explanatory variable). \n\nThis is the super simple version of this plot. It could be improved by dropping NA values and adding labels. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(acs12, aes(x = hrs_work, y = income, color = age)) + \n  geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1041 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](multivariateplots_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nThis is exactly the same plot, but here I'm mapping the age variable using `size` (and I'm dropping NA values--notice how this changes the age scale to start around 20, rather than 0). This varies the size of the points based on the value of age.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacs12 |> \n  filter(!is.na(hrs_work)) |> \n  ggplot(aes(x = hrs_work, y = income, size = age)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![](multivariateplots_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nIn general, income seems to rise with hours worked, at least up to a point. There doesn't seem to be a strong relationship with age, though as they are neither of these plots makes that especially easy to determine.\n\n## Facets\n\nHere, I'll show the relationship between education level, hours worked, and ability status, just like we did in lecture. In lecture we did this using a boxplot. Here, I'll do the same thing using a series of histograms. \n\nThe takeaway from this is that there are many ways to show the same information!\n\nI will be using *facets*--R's word for smaller subplots--to show how the shape of the hours worked histogram changes across different education levels and ability statuses.\n\nFirst, let's temporarily put `disability` aside and just show the relationship between hours worked and education status using histograms and facets.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacs12 |> \n  filter(employment == \"employed\") |> #filtering out people who are not employed\n  ggplot(aes(x = hrs_work)) + \n  geom_histogram(binwidth = 8) +\n  # this additional geom adds a vertical line at 40 hours, where we know everyone's median is\n  # this is not necessary, but it makes it easier to compare distributions\n  geom_vline(xintercept = 40) + \n  # this facet command tells R that it should actually make several small plots,\n  # one for each value of \"edu\" (hs or lower, college, grad)\n  facet_wrap(facets = \"edu\") \n```\n\n::: {.cell-output-display}\n![](multivariateplots_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nNow we have three small plots!\n\nWhat if we want to also show ability status? One way is to use color. \n\nThis time, I will facet by ability status, and use color to show different education levels. I will position the histogram bars next to each other with `position = \"dodge\"`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacs12 |> \n  filter(employment == \"employed\") |> \n  ggplot(aes(x = hrs_work, fill = edu)) + # notice that I added the fill argument here\n  geom_histogram(binwidth = 8, position = \"dodge\") + # and the position = \"dodge\" argument here\n  facet_wrap(facets = \"disability\", # and I changed this to facet by disability instead of edu\n             scales = \"free\") # this argument makes it so that the different facets can have different axis limits--useful here because there are many more respondents without disabilities than with disabilities\n```\n\n::: {.cell-output-display}\n![](multivariateplots_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n### Q1: Facet practice\n\nAnother way to show this same relationship would have been to use color to indicate ability status and facet by education level. Edit the code below to \n\n\n::: {.cell}\n\n```{.r .cell-code}\nacs12 |> \n  filter(employment == \"employed\") |> \n  ggplot(aes(x = hrs_work, fill = edu)) +\n  geom_histogram(binwidth = 8, position = \"dodge\") +\n  facet_wrap(facets = \"disability\", \n             scales = \"free\")\n```\n\n::: {.cell-output-display}\n![](multivariateplots_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "multivariateplots_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}